<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eftimos</title>
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="assets/images/favicon_io/site.webmanifest">
    <link rel="icon" type="image/png" sizes="192x192" href="assets/images/favicon_io/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="assets/images/favicon_io/android-chrome-512x512.png">

    <meta name="description"
        content="An inner house where silence, craft, and the avant-garde meet. Join to receive your access key and early access to releases and updates.">
    <meta name="keywords"
        content="Eftimos, fashion brand, lifestyle brand, exclusive clothing, premium apparel, streetwear, minimal design, modern fashion, unisex fashion, luxury clothing, belonging, individuality">

    <!-- Preload critical fonts -->
    <link rel="preload" href="assets/fonts/Helvetica.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="preload" href="assets/fonts/Helvetica-Bold.ttf" as="font" type="font/ttf" crossorigin>

    <!-- Preload critical CSS -->
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- DNS prefetch for faster resource loading -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">

    <script>
        // Set hero background before page renders (only on forward navigation)
        (function () {
            // Check if this is a back/forward navigation
            const perfEntries = performance.getEntriesByType('navigation');
            const isBackNavigation = perfEntries.length > 0 && perfEntries[0].type === 'back_forward';

            // Only set background on fresh navigation, NOT on back button
            if (!isBackNavigation) {
                const transitionData = sessionStorage.getItem('morphTransition');
                if (transitionData) {
                    const data = JSON.parse(transitionData);
                    // Add inline style to set background immediately
                    const style = document.createElement('style');
                    style.textContent = `.hero { background-image: url('${data.imageSrc}') !important; }`;
                    document.head.appendChild(style);
                }
            }
        })();
    </script>
</head>

<body style="background-color: #1a1a1a;">
    <!-- Grain Canvas -->
    <canvas id="grainCanvas" style="opacity: 0.005;"></canvas>

    <nav class="blending-item">
        <div class="nav-container">
            <!-- Menu Hamburguesa -->
            <div class="menu-toggle" id="menuToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            
            <!-- Logo Centrado -->
            <a href="index.html" class="logo" data-shape="circle">
                <img src="assets/images/logo-white.png" alt="Eftimos Logo" width="150" height="auto" draggable="false">
            </a>
        </div>
        
        <!-- MenÃº Desplegable -->
        <div class="dropdown-menu" id="dropdownMenu">
            <div class="menu-links">
                <a href="https://1peief-wi.myshopify.com/" target="_blank" rel="noopener noreferrer" class="dropdown-link">SHOP</a>
                <div class="dropdown-item-with-submenu">
                    <button class="dropdown-link dropdown-toggle" id="collectionsToggle">
                        COLLECTIONS
                        <svg class="dropdown-arrow" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="submenu" id="collectionsSubmenu">
                        <a href="#nierika" class="submenu-link">NIERIKA</a>
                        <a href="#runway23" class="submenu-link">RUNWAY 23</a>
                    </div>
                </div>
                <button class="dropdown-link" id="contactBtn">CONTACT</button>
            </div>
            
            <!-- Control Icons in Sidebar -->
            <div class="sidebar-controls">
                <div class="sidebar-control-buttons">
                    <button class="sidebar-control-btn" id="visualToggle" title="Toggle Visual Effects">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                            <!-- Icono de ojo abierto -->
                            <path class="eye-open" d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle class="eye-open" cx="12" cy="12" r="3"></circle>
                            <!-- Icono de ojo cerrado (oculto inicialmente) -->
                            <line class="eye-closed" style="display:none;" x1="1" y1="1" x2="23" y2="23" stroke-linecap="round"></line>
                        </svg>
                    </button>
                    <button class="sidebar-control-btn" id="audioToggle" title="Toggle Audio">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                            <!-- Altavoz abierto -->
                            <path class="speaker-on" d="M3 9v6c0 1.105.895 2 2 2h4l5 5V4H9c-1.105 0-2 .895-2 2v3z"></path>
                            <path class="speaker-on" d="M17.5 3.5a4 4 0 0 1 0 5.66M19.07 4.93a8 8 0 0 1 0 11.31"></path>
                            <!-- Altavoz mudo (oculto inicialmente) -->
                            <path class="speaker-off" style="display:none;" d="M11 5L6 9H2v6h4l5 5V5z"></path>
                            <line class="speaker-off" style="display:none;" x1="23" y1="9" x2="17" y2="15"></line>
                            <line class="speaker-off" style="display:none;" x1="17" y1="9" x2="23" y2="15"></line>
                        </svg>
                    </button>
                </div>
                <div class="control-status-message" id="statusMessage"></div>
            </div>
        </div>
    </nav>

    <!-- Contact Form Modal -->
    <div class="contact-modal" id="contactModal">
        <div class="contact-modal-content">
            <button class="contact-close" id="contactClose">&times;</button>
            <h2>CONTACT US</h2>
            <form id="contactForm">
                <div class="form-group">
                    <input type="text" id="name" name="name" placeholder="NAME" required>
                </div>
                <div class="form-group">
                    <input type="email" id="email" name="email" placeholder="EMAIL" required>
                </div>
                <div class="form-group">
                    <textarea id="message" name="message" placeholder="MESSAGE" rows="5" required></textarea>
                </div>
                <button type="submit" class="submit-btn">SEND</button>
            </form>
        </div>
    </div>

    <main>
        <section class="hero" id="heroSection" style="background-image: url(assets/images/g-11.webp);">
            <div class="container">
                <h1>AW20</h1>
            </div>
        </section>

        <section class="grid-view">
            <div class="container-fluid">
                <div class="grid-view-content">
                    <div class="item">
                        <a href="#" class="image-link">
                            <img src="assets/images/g-11.webp" alt="">
                            <span class="tooltip">AW20 Collection</span>
                        </a>
                    </div>
                    <div class="item">
                        <a href="#" class="image-link">
                            <img src="assets/images/g-12.webp" alt="">
                            <span class="tooltip">Winter Editorial</span>
                        </a>
                    </div>
                    <div class="item">
                        <a href="#" class="image-link">
                            <img src="assets/images/g-16.avif" alt="">
                            <span class="tooltip">Avant-Garde Series</span>
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Sonidos - En esta pÃ¡gina usamos whispers como sonido principal -->
    <audio id="noiseSound" src="assets/sounds/whispers.mp3" preload="auto" loop></audio>
    <audio id="whispersSound" src="assets/sounds/whispers.mp3" preload="auto" loop></audio>
    <audio id="lockedInSound" src="assets/sounds/locked-in-oneself.mp3" preload="auto"></audio>

    <!-- Load scripts at the end for better performance -->
    <script src="assets/js/script.js"></script>
    <script src="assets/js/cursor-effect.js"></script>
    <script src="assets/js/grain-effect.js"></script>
    <script src="assets/js/tooltip-nebula.js"></script>
    <script src="assets/js/controls.js"></script>

    <script>
        console.log('ðŸš€ SCRIPT DE WHISPERS INICIADO');
        
        // Override audio settings for clothes-view page - make whispers more audible
        (function() {
            console.log('ðŸš€ FunciÃ³n anÃ³nima ejecutÃ¡ndose...');
            
            const noiseSound = document.getElementById('noiseSound');
            
            if (!noiseSound) {
                console.error('âŒ No se encontrÃ³ el elemento de audio noiseSound');
                console.log('Elementos audio en la pÃ¡gina:', document.querySelectorAll('audio'));
                return;
            }
            
            console.log('âœ“ Audio element encontrado:', noiseSound.src);
            
            // TOMAR CONTROL COMPLETO DEL AUDIO
            const CLOTHES_BASE_VOLUME = 0.2;
            const CLOTHES_HOVER_VOLUME = 0.6;
            let isPlaying = false;
            
            // FunciÃ³n para iniciar el audio
            function startWhispers() {
                if (isPlaying) return;
                
                noiseSound.volume = CLOTHES_BASE_VOLUME;
                noiseSound.muted = false;
                
                noiseSound.play().then(() => {
                    isPlaying = true;
                    console.log('âœ“âœ“âœ“ WHISPERS REPRODUCIENDO - Volumen:', noiseSound.volume);
                }).catch(err => {
                    console.warn('Audio bloqueado:', err.message);
                });
            }
            
            // Intentar iniciar inmediatamente
            setTimeout(startWhispers, 100);
            
            // Asegurar inicio en primera interacciÃ³n
            const handlers = ['click', 'mousemove', 'keydown', 'touchstart'];
            handlers.forEach(event => {
                document.addEventListener(event, startWhispers, { once: true });
            });
            
            // OVERRIDE TOTAL: Interceptar todos los cambios de volumen
            let volumeOverride = CLOTHES_BASE_VOLUME;
            
            // Crear un proxy para controlar el volumen
            Object.defineProperty(noiseSound, '_realVolume', {
                value: noiseSound.volume,
                writable: true
            });
            
            // Actualizar volumen constantemente
            setInterval(() => {
                if (isPlaying && noiseSound.volume !== volumeOverride) {
                    noiseSound.volume = volumeOverride;
                }
            }, 50);
            
            // Escuchar eventos de tooltip DIRECTAMENTE
            window.addEventListener('tooltipShown', () => {
                volumeOverride = CLOTHES_HOVER_VOLUME;
                noiseSound.volume = CLOTHES_HOVER_VOLUME;
                console.log('ðŸ”Š HOVER DETECTADO - Volumen aumentado a:', CLOTHES_HOVER_VOLUME);
            });
            
            window.addEventListener('tooltipHidden', () => {
                volumeOverride = CLOTHES_BASE_VOLUME;
                noiseSound.volume = CLOTHES_BASE_VOLUME;
                console.log('ðŸ”‰ HOVER TERMINADO - Volumen base:', CLOTHES_BASE_VOLUME);
            });
            
            // TAMBIÃ‰N escuchar hover directo en los items por si acaso
            document.addEventListener('DOMContentLoaded', () => {
                const imageLinks = document.querySelectorAll('.grid-view .image-link');
                console.log('ðŸ“ Items encontrados:', imageLinks.length);
                
                imageLinks.forEach((link, index) => {
                    link.addEventListener('mouseenter', () => {
                        volumeOverride = CLOTHES_HOVER_VOLUME;
                        noiseSound.volume = CLOTHES_HOVER_VOLUME;
                        console.log(`ðŸŽ¯ HOVER DIRECTO en item ${index + 1} - Vol:`, CLOTHES_HOVER_VOLUME);
                    });
                    
                    link.addEventListener('mouseleave', () => {
                        volumeOverride = CLOTHES_BASE_VOLUME;
                        noiseSound.volume = CLOTHES_BASE_VOLUME;
                        console.log(`ðŸ‘‹ LEAVE en item ${index + 1} - Vol:`, CLOTHES_BASE_VOLUME);
                    });
                    
                    link.addEventListener('click', () => {
                        console.log('ðŸ’¥ CLICK - Fade out');
                        let vol = noiseSound.volume;
                        const fade = setInterval(() => {
                            vol -= 0.05;
                            if (vol <= 0) {
                                volumeOverride = 0;
                                noiseSound.volume = 0;
                                clearInterval(fade);
                            } else {
                                volumeOverride = vol;
                                noiseSound.volume = vol;
                            }
                        }, 20);
                    });
                });
            });
            
            // DEBUG: Mostrar estado cada 2 segundos
            setInterval(() => {
                if (isPlaying) {
                    console.log('ðŸ“Š Estado:', {
                        playing: !noiseSound.paused,
                        volume: noiseSound.volume,
                        muted: noiseSound.muted,
                        src: noiseSound.src.split('/').pop()
                    });
                }
            }, 2000);
        })();
    </script>

    <script>
        // Override grain effect intensity for this page
        if (typeof updateGrain !== 'undefined') {
            window.updateGrain = function() {
                const imageData = grainCtx.createImageData(grainCanvas.width, grainCanvas.height);
                const centerX = grainCanvas.width / 2;
                const centerY = grainCanvas.height / 2;
                const maxDist = Math.sqrt(centerX**2 + centerY**2);

                for (let y = 0; y < grainCanvas.height; y++) {
                    for (let x = 0; x < grainCanvas.width; x++) {
                        const i = (y * grainCanvas.width + x) * 4;
                        const val = Math.random() * 255;

                        const dx = x - centerX;
                        const dy = y - centerY;
                        const dist = Math.sqrt(dx*dx + dy*dy) / maxDist;

                        // Reduce alpha drastically (from 0-100 to 0-2)
                        const alpha = (dist) * 2;

                        imageData.data[i] = val;
                        imageData.data[i + 1] = val;
                        imageData.data[i + 2] = val;
                        imageData.data[i + 3] = alpha;
                    }
                }

                grainCtx.putImageData(imageData, 0, 0);
            };
        }

        window.addEventListener('popstate', function () {
            window.location.href = 'index.html';
        });

        // Menu toggle functionality
        document.addEventListener('DOMContentLoaded', function() {
            const menuToggle = document.getElementById('menuToggle');
            const dropdownMenu = document.getElementById('dropdownMenu');
            const body = document.body;

            if (menuToggle && dropdownMenu) {
                menuToggle.addEventListener('click', function() {
                    menuToggle.classList.toggle('active');
                    dropdownMenu.classList.toggle('active');
                    body.classList.toggle('menu-open');
                });
            }

            // Collections submenu toggle
            const collectionsToggle = document.getElementById('collectionsToggle');
            const collectionsSubmenu = document.getElementById('collectionsSubmenu');

            if (collectionsToggle && collectionsSubmenu) {
                collectionsToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    collectionsSubmenu.classList.toggle('active');
                    collectionsToggle.classList.toggle('active');
                });
            }

            // Contact modal functionality
            const contactBtn = document.getElementById('contactBtn');
            const contactModal = document.getElementById('contactModal');
            const contactClose = document.getElementById('contactClose');

            if (contactBtn && contactModal && contactClose) {
                contactBtn.addEventListener('click', function() {
                    contactModal.classList.add('active');
                });

                contactClose.addEventListener('click', function() {
                    contactModal.classList.remove('active');
                });

                contactModal.addEventListener('click', function(e) {
                    if (e.target === contactModal) {
                        contactModal.classList.remove('active');
                    }
                });
            }

            // Logo click transition to white
            const logoLink = document.querySelector('.logo');
            if (logoLink) {
                logoLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetUrl = this.getAttribute('href');
                    
                    // Create white overlay
                    let overlay = document.getElementById('transitionOverlay');
                    if (!overlay) {
                        overlay = document.createElement('div');
                        overlay.id = 'transitionOverlay';
                        overlay.style.position = 'fixed';
                        overlay.style.top = '0';
                        overlay.style.left = '0';
                        overlay.style.right = '0';
                        overlay.style.bottom = '0';
                        overlay.style.background = 'white';
                        overlay.style.zIndex = '100000';
                        overlay.style.pointerEvents = 'none';
                        overlay.style.opacity = '0';
                        overlay.style.transition = 'opacity 0.45s ease';
                        document.body.appendChild(overlay);
                    }
                    
                    // Trigger fade to white
                    requestAnimationFrame(() => {
                        overlay.style.opacity = '1';
                    });
                    
                    // Navigate after transition
                    setTimeout(() => {
                        window.location.href = targetUrl;
                    }, 450);
                });
            }
        });
    </script>
</body>

</html>